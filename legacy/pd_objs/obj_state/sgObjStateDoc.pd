#N canvas 896 207 702 145 10;
#X text 32 105 define an "instrument" as an stateful object with 2
properties:;
#X text 40 262 lets define a listener which wants to always track the
instruments state;
#X obj 152 308 t a a;
#X obj 122 386 route pitch volume;
#X floatatom 122 409 5 0 0 0 - - -;
#X floatatom 174 409 5 0 0 0 - - -;
#X obj 152 285 r listener;
#X text 48 578 if the listener is connected \, it stays informed:;
#X obj 319 335 r x;
#X obj 319 358 print x;
#N canvas 0 30 846 854 save 0;
#X obj 105 231 sgObjSetAll;
#X obj 582 253 sgObjSetAll;
#X msg 680 167 clear;
#X obj 642 135 t a b;
#X msg 475 175 read;
#X obj 613 98 sgObjGetAll GLOBAL;
#X msg 574 129 write;
#X msg 442 233 file \$1;
#X obj 580 216 sgIOText /tmp/bla;
#X obj 116 91 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 117 168 list;
#X obj 96 146 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 601 70 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 471 129 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X symbolatom 442 208 10 0 0 0 - - -;
#X text 102 65 save to ram;
#X text 8 149 load from ram;
#X text 507 65 save to disk:;
#X text 367 130 load from disk:;
#X text 328 206 change filename:;
#X obj 164 159 print;
#X obj 183 204 print loading;
#X obj 141 132 sgObjGetAll \$0-GLOBAL;
#X connect 2 0 8 0;
#X connect 3 0 8 1;
#X connect 3 1 2 0;
#X connect 4 0 8 0;
#X connect 5 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 8 0;
#X connect 7 0 8 0;
#X connect 8 0 1 0;
#X connect 9 0 22 0;
#X connect 10 0 0 0;
#X connect 11 0 10 0;
#X connect 12 0 5 0;
#X connect 13 0 4 0;
#X connect 14 0 7 0;
#X connect 22 0 10 1;
#X restore 587 94 pd save all objects;
#X obj 29 340 sgEventToMessage;
#X obj 597 146 sgObjUI \$0-GLOBAL;
#X obj 63 200 ExampleObj weirdInstrument \$0-GLOBAL;
#X obj 61 135 ExampleObj obscureInstrument \$0-GLOBAL;
#X obj 198 328 print listener;
#X text 30 22 This module is just a convention how to build high level
objects in a patch.;
#N canvas 0 30 894 854 properties 1;
#X text 559 159 args: name "\$0" init? loadbang?;
#X obj 135 152 sgProperty testProp \$0 42;
#X obj 135 175 print propOut;
#X floatatom 200 61 5 0 0 0 - - -;
#X obj 280 180 print redirect;
#X text 321 205 redirect to other properties;
#X symbolatom 233 264 10 0 0 0 - - -;
#X obj 142 382 print propOut;
#X obj 313 382 print redirect;
#X obj 145 606 sgPropertyList testProp \$0;
#X msg 372 117 get;
#X msg 111 82 get testProp;
#X msg 200 85 set testProp \$1;
#X msg 659 307 list get 1 bla;
#X obj 567 402 print;
#X obj 735 406 print ctrlMsg;
#X msg 574 338 get bla;
#X msg 130 293 get testProp;
#X msg 233 294 set testProp \$1;
#X msg 372 289 get otherProp;
#X msg 373 94 get otherProp;
#X obj 142 357 sgPropertySym testProp \$0 bla;
#X obj 150 644 print propOut;
#X obj 321 644 print redirect;
#X msg 98 522 get testProp;
#X msg 382 536 get otherProp;
#X obj 242 510 list prepend set testProp;
#X obj 242 533 list trim;
#X msg 344 469 list;
#X msg 324 443 list a b c;
#X msg 372 313 get;
#X msg 421 322 other obscure msg 0;
#X msg 421 121 other obscure msg 0;
#X msg 374 570 other obscure msg 0;
#X obj 567 379 sgObjStateIn \$0-rcv \$0-glob_rcv;
#X obj 556 201 r \$0-testProp;
#X obj 556 224 print testProp.priv;
#X connect 1 0 2 0;
#X connect 1 1 4 0;
#X connect 3 0 12 0;
#X connect 6 0 18 0;
#X connect 9 0 22 0;
#X connect 9 1 23 0;
#X connect 10 0 1 0;
#X connect 11 0 1 0;
#X connect 12 0 1 0;
#X connect 13 0 34 0;
#X connect 16 0 34 0;
#X connect 17 0 21 0;
#X connect 18 0 21 0;
#X connect 19 0 21 0;
#X connect 20 0 1 0;
#X connect 21 0 7 0;
#X connect 21 1 8 0;
#X connect 24 0 9 0;
#X connect 25 0 9 0;
#X connect 26 0 27 0;
#X connect 27 0 9 0;
#X connect 28 0 26 0;
#X connect 29 0 26 0;
#X connect 30 0 21 0;
#X connect 31 0 21 0;
#X connect 32 0 1 0;
#X connect 33 0 9 0;
#X connect 34 0 14 0;
#X connect 34 1 15 0;
#X connect 35 0 36 0;
#X restore 55 67 pd properties;
#X text 151 68 (how to define "properties");
#X text 544 120 "generic" gui to read/write objects:;
#N canvas 0 30 846 411 other 0;
#X obj 329 241 send;
#X obj 231 186 sgPackFromHuman;
#X msg 282 44 out ( add listener );
#X msg 284 71 out ( clear );
#X msg 312 123 out ( del listener );
#X msg 291 96 out ( set listener x );
#X obj 434 169 loadbang;
#X msg 434 193 symbol obscureInstrument.in;
#X msg 438 221 symbol weirdInstrument.in;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 1 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X connect 6 0 7 0;
#X connect 7 0 0 1;
#X connect 8 0 0 1;
#X restore 391 528 pd other connection msgs;
#X text 303 141 <- open abstractio to see details;
#X text 41 479 we can now register "listener" to stay informed about
the instrument:;
#N canvas 0 30 798 854 other 0;
#X floatatom 98 121 5 0 0 0 - - -;
#X floatatom 146 94 5 0 0 0 - - -;
#X obj 501 185 send, f 8;
#X obj 462 157 sgPackFromHuman;
#X msg 197 91 set ( name instrument );
#X msg 470 73 start ( pitch ( 3 ) volume ( 0.5 ) );
#X msg 382 74 start ( );
#X msg 573 155 symbol obscureInstrument.in;
#X obj 574 131 loadbang;
#X msg 98 143 set ( pitch ( \$1 ) );
#X msg 145 117 set ( volume ( \$1 ) );
#X msg 577 183 symbol weirdInstrument.in;
#X connect 0 0 9 0;
#X connect 1 0 10 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X connect 5 0 3 0;
#X connect 6 0 3 0;
#X connect 7 0 2 1;
#X connect 8 0 7 0;
#X connect 9 0 3 0;
#X connect 10 0 3 0;
#X connect 11 0 2 1;
#X restore 396 630 pd other control msgs;
#X floatatom 77 603 5 0 0 0 - - -;
#X text 391 649 (setting properties);
#X text 281 746 (get current pitch);
#X text 282 789 (get all properties + extra infos);
#X text 51 696 we can ask the instrument to inform us (the "listener")
about its state:;
#X floatatom 208 605 5 0 0 0 - - -;
#X obj 122 363 route set;
#X obj 79 654 s obscureInstrument;
#X msg 208 627 list set 3 pitch 1 \$1;
#X msg 79 631 set pitch \$1;
#X obj 208 652 s obscureInstrument.in;
#X text 208 671 send as "event";
#X text 74 672 send as normal msg;
#X msg 76 512 \; obscureInstrument.in out 2 add listener \;;
#X msg 82 737 \; obscureInstrument get pitch \;;
#X msg 83 780 \; obscureInstrument.in get 0;
#X text 548 43 The "GLOBAL" interface is slightly broken:;
#X connect 2 0 11 0;
#X connect 2 1 15 0;
#X connect 3 0 4 0;
#X connect 3 1 5 0;
#X connect 6 0 2 0;
#X connect 8 0 9 0;
#X connect 11 1 30 0;
#X connect 24 0 33 0;
#X connect 29 0 32 0;
#X connect 30 0 3 0;
#X connect 32 0 34 0;
#X connect 33 0 31 0;
